<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
<!--  <title>City & Area Entry</title>-->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Bootstrap Select CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.14.0-beta3/css/bootstrap-select.min.css">

  <link rel="stylesheet" href="/headerAndNav.css" />
</head>
<body class="p-5">
<div th:replace="headerAndNav :: headerAndNav"></div>

<div class="container">
  <h2>City & Area Entry</h2>
  <form th:action="@{/saveCityArea}" th:object="${cityArea}" method="post">

    <div class="mb-3">
      <label for="state" class="form-label">State</label>
      <select id="state" name="stateCode"
              class="form-select selectpicker"
              data-live-search="true"  data-width="100%" required>
        <option value="" disabled selected>Select State</option>
        <option th:each="state : ${state}" th:value="${state.code}"
                th:text="${state.code + '-' + state.state}">
        </option>
      </select>
    </div>
    <!-- City Name Input Box -->
    <div class="mb-3">
      <label for="cityName" class="form-label">City Name</label>
      <input type="text" id="cityName" name="cityName" class="form-control" th:field="*{city}" placeholder="Enter City Name" required>
    </div>

    <!-- Area Name Input Box -->
    <div class="mb-3">
      <label for="areaName" class="form-label">Area Name</label>
      <input type="text" id="areaName" name="areaName" class="form-control" th:field="*{areaName}" placeholder="Enter Area Name" required>
    </div>

    <!-- Submit and Back Buttons -->
    <button type="submit" class="btn btn-primary">Submit</button>
    <a th:href="@{/dashBoard}" class="btn btn-secondary">Back</a>
  </form>

  <!-- Table -->
  <table class="table table-bordered mt-4">
    <thead>
    <tr>
      <th>Id</th>
      <th>State Name</th>
      <th>City Name</th>
      <th>Area Name</th>
      <th>Action</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="entry : ${cityAreaList}">
      <td th:text="${entry.cityId}"></td>
<!--      <td th:text="${entry.state.code}"></td>-->
      <td th:text="${entry.state != null ? entry.state.state : 'N/A'}"></td>
      <td th:text="${entry.cityName}"></td>
      <td> <span th:each="area : ${entry.areaEntityList}" th:text="${area.area}"></span></td>
<!--      <td>-->
<!--        <a th:href="@{'/edit/' + ${entry.id}}" class="btn btn-sm btn-warning">Edit</a>-->
<!--        <a th:href="@{'/delete/' + ${entry.id}}" class="btn btn-sm btn-danger"-->
<!--           onclick="return confirm('Are you sure you want to delete this entry?');">Delete</a>-->
<!--      </td>-->
    </tr>
    </tbody>
  </table>
</div>
<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

<!-- Bootstrap Bundle JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<!-- Bootstrap Select JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.14.0-beta3/js/bootstrap-select.min.js"></script>

<script>
  $(document).ready(function() {
    $('.selectpicker').selectpicker();
  });


   document.addEventListener('DOMContentLoaded', function () {
  const sidebar = document.getElementById('sidebar');
  const bsOffcanvas = new bootstrap.Offcanvas(sidebar);

  let lastSpaceTime = 0;
  let spacePressed = false;

  document.addEventListener('keydown', function (event) {
    if (event.key === ' ') {

      // âœ… If focused element is input/textarea/contenteditable, do nothing
      const active = document.activeElement;
      const isTyping = active.tagName === 'INPUT' ||
                       active.tagName === 'TEXTAREA' ||
                       active.isContentEditable;

      if (isTyping) {
        // Let the normal space work
        return;
      }

      // ðŸ‘‰ Else handle sidebar toggle
      event.preventDefault();
      const now = Date.now();
      if (spacePressed && (now - lastSpaceTime) < 400) {
        bsOffcanvas.show();
        spacePressed = false;
      } else {
        spacePressed = true;
        lastSpaceTime = now;
        setTimeout(() => {
          if (spacePressed) {
            bsOffcanvas.hide();
            spacePressed = false;
          }
        }, 400);
      }
    }
  });
});

</script>

</body>
</html>
